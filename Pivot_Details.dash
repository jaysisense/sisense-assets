{"title":"Pivot Details","oid":"5afa047ec204b8295c266c93","desc":"","source":null,"type":"dashboard","style":{"name":"vivid","palette":{"colors":["#00cee6","#9b9bd7","#6EDA55","#fc7570","#fbb755","#218A8C"],"name":"Vivid","sortOrder":50,"isSystem":true,"systemDefault":true}},"layout":{"instanceid":"631C8-BD53-37","type":"columnar","columns":[{"width":100,"cells":[{"subcells":[{"elements":[{"minHeight":128,"maxHeight":2048,"minWidth":128,"maxWidth":2048,"height":12864,"defaultWidth":512,"widgetid":"5afa04cdc204b8295c266cb9"}],"width":100,"stretchable":false,"pxlWidth":1884,"index":0}]}],"pxlWidth":1884,"index":0}],"container":{}},"datasource":{"title":"OneTrustEC","fullname":"LocalHost/OneTrustEC","id":"aLOCALHOST_aONETRUSTEC","address":"LocalHost","database":"aOneTrustEC"},"editing":true,"filters":[{"jaql":{"table":"Inventory","column":"Name","dim":"[Inventory.Name]","datatype":"text","merged":true,"title":"Name","datasource":{"title":"OneTrustEC","fullname":"LocalHost/OneTrustEC","id":"aLOCALHOST_aONETRUSTEC","address":"LocalHost","database":"aOneTrustEC","lastBuildTime":"2018-05-10T10:27:15"},"collapsed":false,"filter":{"explicit":true,"multiSelection":true,"members":["100 Test Process","103 Test Process x","105 Test Process","101 Test Process","10 Test Process"]}},"instanceid":"F462C-9407-2A","isCascading":false,"disabled":true}],"filterToDatasourceMapping":{},"previewLayout":[{"type":"previewLayout","format":"A3","orientation":"landscape","layout":"asis","headerSize":"compact","title":true,"elasticubeBuilt":true,"elasticubeName":true,"filters":true,"logo":false,"pageNumbers":true,"pages":[{"columns":[{"width":100,"cells":[{"subcells":[{"elements":[{"minHeight":128,"maxHeight":1024,"height":767,"widgetid":"5afa04cdc204b8295c266cb9"}],"width":100}]}]}]}],"savedByButton":"Export","openPath":"PDF Settings"}],"parentFolder":"58d3c51389d2794420000123","widgets":[{"title":"","subtype":"pivot","oid":"5afa04cdc204b8295c266cb9","desc":null,"source":null,"datasource":{"title":"OneTrustEC","fullname":"LocalHost/OneTrustEC","id":"aLOCALHOST_aONETRUSTEC","address":"LocalHost","database":"aOneTrustEC","lastBuildTime":"2018-05-10T10:27:15"},"selection":null,"metadata":{"ignore":{"dimensions":[],"all":false},"panels":[{"name":"rows","items":[{"jaql":{"table":"Inventory","column":"DataInventoryId","dim":"[Inventory.DataInventoryId]","datatype":"text","merged":true,"title":"DataInventoryId"},"field":{"id":"[Inventory.DataInventoryId]","index":0},"format":{"width":183}},{"jaql":{"table":"Inventory","column":"Name","dim":"[Inventory.Name]","datatype":"text","merged":true,"title":"Name"},"field":{"id":"[Inventory.Name]","index":1}}]},{"name":"values","items":[{"jaql":{"table":"Inventory","column":"Value","dim":"[Inventory.Value]","datatype":"text","merged":true,"agg":"count","title":"# of unique Value"},"format":{"mask":{"type":"number","t":true,"b":true,"separated":true,"decimals":"auto","isdefault":true},"color":{"type":"color","color":"transparent"}},"field":{"id":"[Inventory.Value]_count","index":3}}]},{"name":"columns","items":[{"jaql":{"table":"Inventory","column":"Attribute","dim":"[Inventory.Attribute]","datatype":"text","merged":true,"title":"Attribute"},"field":{"id":"[Inventory.Attribute]","index":2},"format":{"width":179}}]},{"name":"filters","items":[{"jaql":{"table":"Inventory","column":"Name","dim":"[Inventory.Name]","datatype":"text","merged":true,"title":"Name","filter":{"explicit":true,"multiSelection":true,"members":["1 Test Process","10 Test Process","100 Test Process"]},"datasource":{"title":"OneTrustEC","fullname":"LocalHost/OneTrustEC","id":"aLOCALHOST_aONETRUSTEC","address":"LocalHost","database":"aOneTrustEC","lastBuildTime":"2018-05-10T10:27:15"},"collapsed":false},"disabled":true},{"jaql":{"table":"Inventory","column":"Attribute","dim":"[Inventory.Attribute]","datatype":"text","merged":true,"title":"Attribute","filter":{"explicit":true,"multiSelection":true,"members":["Business Process Owner","carmen1","Data Source","Data Subjects Region","Data Subjects Volume"]},"collapsed":false,"datasource":{"title":"OneTrustEC","fullname":"LocalHost/OneTrustEC","id":"aLOCALHOST_aONETRUSTEC","address":"LocalHost","database":"aOneTrustEC","lastBuildTime":"2018-05-10T10:27:15"}}}]}]},"type":"pivot","iconSmall":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAYCAYAAAC8/X7cAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFDOTk4NjMxNzU1MTExRTM4QkE0QjUwRjg4NjAzOUM1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFDOTk4NjMyNzU1MTExRTM4QkE0QjUwRjg4NjAzOUM1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUM5OTg2MkY3NTUxMTFFMzhCQTRCNTBGODg2MDM5QzUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUM5OTg2MzA3NTUxMTFFMzhCQTRCNTBGODg2MDM5QzUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4Ed6mDAAACVUlEQVR42uyYzytmURjHXWPCbsTkHxAyG1Ga1SSr2chWJFnIu2AW76zFQkqzkCl2RLGXpYVSFhZIfkzZyMbPMRYkkVyfh0P3feec+97z3iMppz6d4znnfu/z3POcHy/P9/2ct1xyc956kRmAev+xVL/EO77UNtSDD9Wufc+LKfCRqgxEZ9fzvEvHgafob68uXDpJIXEc+mkewx/YgH/YJqDYhePwnz62CSiOFQAOfqCagz4oCnTlQwcsM6YkhvMZ9RlTEmcGfsD3kH6Z8pEYE2Cln2f4yoVKSKZrhNzeD3QnIjjRjEYPz50ZvnKKPrltrY9GD/WZaREPQFK1v8FXFVgBVXnE7bkKlmz0ccpa35RClYF2RaB9Z5EKYWOd6ZsCkByTLUuO6cEnIylxQ7UZQVzGbYX0a/VJJWt9bQA4Ok/1WXYB2r/Sun9HeMEUz52bOnH0WZ92Vvo8d25cxCqIK6orTde4yts2w6Nr8DOTBzjgRD83w57fCutwCDNQSmAy7e3QLadjYPhfGJKXM+Yi4p7fCutwCDNQSmAZ9RlzEbqNKuebqKYDphZZcNjrcFAW0KigDi3ROVH2qAeWVh97HQ4+66tD60Ff2VNK2F2oU2OrhRpYCaTaaZYHViR9nD7N9jpdYLDnO7qrOdEPC2BWYzsIfp2YxYl+WABjMAy36u8daCRlrh0FoNUnZaz0w7ZRWTBJFmkv9ae0+1DsohZkkkX6oJ92H8o6gAQOH5l+/ViUPQKe1NgTOHxk2JWs9Al4UhdAl6MPvAi6AJzre+//lXjlci/AAOnMDanQIR59AAAAAElFTkSuQmCC","iconSmallWizard":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAYCAYAAAC8/X7cAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFDOTk4NjMxNzU1MTExRTM4QkE0QjUwRjg4NjAzOUM1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFDOTk4NjMyNzU1MTExRTM4QkE0QjUwRjg4NjAzOUM1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUM5OTg2MkY3NTUxMTFFMzhCQTRCNTBGODg2MDM5QzUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUM5OTg2MzA3NTUxMTFFMzhCQTRCNTBGODg2MDM5QzUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4Ed6mDAAACVUlEQVR42uyYzytmURjHXWPCbsTkHxAyG1Ga1SSr2chWJFnIu2AW76zFQkqzkCl2RLGXpYVSFhZIfkzZyMbPMRYkkVyfh0P3feec+97z3iMppz6d4znnfu/z3POcHy/P9/2ct1xyc956kRmAev+xVL/EO77UNtSDD9Wufc+LKfCRqgxEZ9fzvEvHgafob68uXDpJIXEc+mkewx/YgH/YJqDYhePwnz62CSiOFQAOfqCagz4oCnTlQwcsM6YkhvMZ9RlTEmcGfsD3kH6Z8pEYE2Cln2f4yoVKSKZrhNzeD3QnIjjRjEYPz50ZvnKKPrltrY9GD/WZaREPQFK1v8FXFVgBVXnE7bkKlmz0ccpa35RClYF2RaB9Z5EKYWOd6ZsCkByTLUuO6cEnIylxQ7UZQVzGbYX0a/VJJWt9bQA4Ok/1WXYB2r/Sun9HeMEUz52bOnH0WZ92Vvo8d25cxCqIK6orTde4yts2w6Nr8DOTBzjgRD83w57fCutwCDNQSmAy7e3QLadjYPhfGJKXM+Yi4p7fCutwCDNQSmAZ9RlzEbqNKuebqKYDphZZcNjrcFAW0KigDi3ROVH2qAeWVh97HQ4+66tD60Ff2VNK2F2oU2OrhRpYCaTaaZYHViR9nD7N9jpdYLDnO7qrOdEPC2BWYzsIfp2YxYl+WABjMAy36u8daCRlrh0FoNUnZaz0w7ZRWTBJFmkv9ae0+1DsohZkkkX6oJ92H8o6gAQOH5l+/ViUPQKe1NgTOHxk2JWs9Al4UhdAl6MPvAi6AJzre+//lXjlci/AAOnMDanQIR59AAAAAElFTkSuQmCC","style":{"pageSize":25,"automaticHeight":true,"colors":{"rows":true,"columns":false,"headers":false,"members":false,"totals":false},"narration":{"enabled":false,"display":"above","format":"bullets","verbosity":"medium","up_sentiment":"good","aggregation":"sum","labels":[{"id":"datainventoryid","title":"DataInventoryId","singular":"DataInventoryId","plural":"DataInventoryId"},{"id":"name","title":"Name","singular":"Name","plural":"Name"},{"id":"attribute","title":"Attribute","singular":"Attribute","plural":"Attribute"}]}},"instanceid":"2A584-59CD-9B","queryStartTime":"2018-05-15T14:13:10","drawing":true,"widgetTimingLoged":false,"drillToDashboardConfig":{"drilledDashboardPrefix":"_drill","drilledDashboardsFolderPrefix":"","displayFilterPane":true,"displayDashboardsPane":true,"displayToolbarRow":true,"displayHeaderRow":true,"volatile":false,"hideDrilledDashboards":true,"drillToDashboardMenuCaption":"Jump to dashboard","drillToDashboardRightMenuCaption":"Jump to ","drillToDashboardNavigateType":1,"drillToDashboardNavigateTypePivot":2,"drillToDashboardNavigateTypeCharts":1,"drillToDashboardNavigateTypeOthers":3,"excludeFilterDims":[],"includeFilterDims":[],"drilledDashboardDisplayType":2,"dashboardIds":[],"modalWindowResize":false,"showFolderNameOnMenuSelection":false,"resetDashFiltersAfterJTD":false,"sameCubeRestriction":true,"showJTDIcon":true},"canEditFilters":true,"viewState":{"activeTab":"filters"},"realTimeRefreshing":false,"dashboardid":"5afa047ec204b8295c266c93","options":{"dashboardFiltersMode":"filter","selector":false,"triggersDomready":true,"drillToAnywhere":true,"autoUpdateOnEveryChange":true},"script":null,"script_old":"var jaql1 =  {\n\t\"datasource\": {\n\t\t\"title\": \"OneTrustEC\",\n\t\t\"fullname\": \"LocalHost/OneTrustEC\",\n\t\t\"id\": \"aLOCALHOST_aONETRUSTEC\",\n\t\t\"address\": \"LocalHost\",\n\t\t\"database\": \"aOneTrustEC\",\n\t\t\"lastBuildTime\": \"2018-05-10T10:27:15\"\n\t},\n\n\t\"metadata\": [\n\t\t{\n\t\t\t\"jaql\": {\n\t\t\t\t\"table\": \"Inventory\",\n\t\t\t\t\"column\": \"DataInventoryId\",\n\t\t\t\t\"dim\": \"[Inventory.DataInventoryId]\",\n\t\t\t\t\"datatype\": \"text\",\n\t\t\t\t\"merged\": true,\n\t\t\t\t\"title\": \"DataInventoryId\"\n\t\t\t},\n\t\t\t\"field\": {\n\t\t\t\t\"id\": \"[Inventory.DataInventoryId]\",\n\t\t\t\t\"index\": 0\n\t\t\t},\n\t\t\t\"format\": {\n\t\t\t\t\"width\": 246\n\t\t\t},\n\t\t\t\"panel\": \"rows\",\n\t\t\t\"handlers\": []\n\t\t},\n\t\t{\n\t\t\t\"jaql\": {\n\t\t\t\t\"table\": \"Inventory\",\n\t\t\t\t\"column\": \"Name\",\n\t\t\t\t\"dim\": \"[Inventory.Name]\",\n\t\t\t\t\"datatype\": \"text\",\n\t\t\t\t\"merged\": true,\n\t\t\t\t\"title\": \"Name\"\n\t\t\t},\n\t\t\t\"field\": {\n\t\t\t\t\"id\": \"[Inventory.Name]\",\n\t\t\t\t\"index\": 1\n\t\t\t},\n\t\t\t\"panel\": \"rows\",\n\t\t\t\"handlers\": []\n\t\t},\n\t\t{\n\t\t\t\"jaql\": {\n\t\t\t\t\"table\": \"Inventory\",\n\t\t\t\t\"column\": \"Attribute\",\n\t\t\t\t\"dim\": \"[Inventory.Attribute]\",\n\t\t\t\t\"datatype\": \"text\",\n\t\t\t\t\"merged\": true,\n\t\t\t\t\"title\": \"Attribute\"\n\t\t\t},\n\t\t\t\"field\": {\n\t\t\t\t\"id\": \"[Inventory.Attribute]\",\n\t\t\t\t\"index\": 2\n\t\t\t},\n\t\t\t\"panel\": \"rows\",\n\t\t\t\"handlers\": []\n\t\t},\n\t\t{\n\t\t\t\"jaql\": {\n\t\t\t\t\"table\": \"Inventory\",\n\t\t\t\t\"column\": \"Value\",\n\t\t\t\t\"dim\": \"[Inventory.Value]\",\n\t\t\t\t\"datatype\": \"text\",\n\t\t\t\t\"merged\": true,\n\t\t\t\t\"title\": \"Value\"\n\t\t\t},\n\t\t\t\"field\": {\n\t\t\t\t\"id\": \"[Inventory.Value]\",\n\t\t\t\t\"index\": 3\n\t\t\t},\n\t\t\t\"panel\": \"rows\",\n\t\t\t\"handlers\": []\n\t\t},\n\t\t{\n\t\t\t\"jaql\": {\n\t\t\t\t\"formula\": \"0\",\n\t\t\t\t\"type\": \"measure\"\n\t\t\t},\n\t\t\t\"panel\": \"measures\",\n\t\t\t\"handlers\": []\n\t\t}\n\t],\n\t\"isMaskedResult\": true\n};\n\n\nwidget.on('ready', function(w,args) {\n\t \n\tvar j = prism.debugging.GetJaql(w);\n\n\n\t//debugger;\n\t\n\tvar $http = prism.$injector.get(\"$http\");\n\t\t//debugger;\n\t\n\tvar urlS = \"/api/elasticubes/OneTrustEC/jaql\"\n\t\n\tvar nr = prism.tableGetRowCount(element) ;\n\tvar col = prism.tableGetColHeaders(element);\n\t\n\tvar jaqlStr = JSON.stringify(jaql1);\n\t\n\tvar numH = 2;\n\t\n\t$.ajax({\n\t\t    async: false, \n\t\t\tmethod: \"POST\",\n\t\t\tdata: jaqlStr,\n\t\t\tcontentType: \"application/json\",\n\t        url : urlS,\n            success: function(response){\n                //debugger;\n\t\t\t\tvar valArr =  response.values;\n\t\t\t\tvar v = 0;\n\t\t\t\n\t\t\t\t// scan the table cell by cell, starting from the first summary cell\n\t\t\t\tfor(var r = 0; r < nr; r++) {\n\t\t\t\t\tvar hArr = [];\n\t\t\t\t\t\t\n\t\t\t\t\t//get the header values on the row\n\t\t\t\t\tfor(var h = 0; h < numH; h++) {\n\t\t\t\t\t\thArr[h] = prism.tableGetCellVal(r, h, element);\t\t  \n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//loop through each column on the row\n\t\t\t\t\tfor(var c = numH; c < col.length; c++) {\n\t\t\t\t\t\tvar $d = prism.tableGetCellDiv(r, c, element);  \n\t\t\t\t\t\tvar cVal = col[c];\n\t\t\t\t\t\tvar cellS = findMatch(valArr, hArr, cVal);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(cellS != '') {\n\t\t\t\t\t\t\tcellS = cellS.substring(1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log(cellS);\t\t\t\t\t\n\t\t\t\t\t\t//set the string in the cell\n\t\t\t\t\t\t//console.log('div', $d.html())\t\t\t\t\n\t\t\t\t\t\t$d.html(cellS);\n\n\t\t\t\n\t\t\t\t\t}\t\n\t\t\t\t}\n            }});\n    /*\n\t$http.post(url, JSON.stringify(jaql1)).then(function(response) {\n\t\tdebugger; \n\t\t\t\n\t});\n\t*/\n\t\n});\n\n\nfunction findMatch(valArr, hArr, cVal) {\n\t//scan the result of the api call record by record\n\t//assumes n row headers and 1 column header\n\t\n\t\n\tvar cellS = '';\n\tvar match = false;\n\tvar numH = hArr.length;\n\t\n\tfor(var v = 0; v < valArr.length; v++) {\t\t\t   \n\t\tvar rec = valArr[v];\n\t\t\n\t\t\n\t\t//match the column\n\t\tif(cVal != rec[numH].data) {\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tvar headMatch = true;\n\t\t\n\t\t//match the headers\n\t\tfor(var h = 0; h < numH; h++) {\n\t\t\tif(rec[h].data != hArr[h]) {\n\t\t\t\theadMatch = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t//optimized to stop searching once there is no match, after the first match\n\t\tif(!headMatch && cellS != '') {\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tif(headMatch) {\n\t\t\tcellS = cellS + ',' + rec[numH + 1].data;\n\t\t}\n\t\t\t\t\t\t   \t\t\t\t   \n\t}\t\n\t\n\treturn cellS;\n}"}]}